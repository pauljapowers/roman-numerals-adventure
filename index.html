<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roman Numerals Learning Game</title>
    <style>
        body { font-family: Arial, sans-serif; background: linear-gradient(to bottom, #ffd55c 50%, #5a94ff 50%); margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: auto; background: white; padding: 20px; border-radius: 10px; }
        .section { display: none; }
        #nav { display: flex; justify-content: space-around; margin-bottom: 20px; }
        button { padding: 10px; cursor: pointer; }
        #character { position: fixed; bottom: 10px; right: 10px; width: 150px; }
        #speech { background: #fff; border: 1px solid; padding: 5px; border-radius: 5px; margin-top: 5px; }
        .draggable { display: inline-block; padding: 10px; background: #eee; margin: 5px; cursor: move; }
        #dropzone { border: 2px dashed #000; min-height: 50px; padding: 10px; margin: 10px 0; }
        #matching .pair { display: flex; justify-content: space-between; margin: 10px 0; }
        #matching .drop { border: 1px solid; width: 100px; height: 50px; }
        img { max-width: 100%; height: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Roman Numerals Adventure</h1>
        <div id="nav">
            <button onclick="showSection('tutorial')">Tutorial</button>
            <button onclick="showSection('converter')">Converter</button>
            <button onclick="showSection('builder')">Builder</button>
            <button onclick="showSection('quiz')">Quiz</button>
            <button onclick="showSection('matching')">Matching</button>
            <button onclick="showSection('history')">History</button>
            <button onclick="downloadCertificate()">Certificate</button>
        </div>
        <div id="tutorial" class="section">
            <h2>Tutorial</h2>
            <p>Rules: I=1, V=5, X=10, L=50, C=100, D=500, M=1000. Subtractives: IV=4, IX=9, etc.</p>
            <img src="https://via.placeholder.com/300?text=Ancient+Roman+Scene" alt="Ancient Rome">
            <p>Modern use: In clocks, movies (e.g., MMXXVI = 2026).</p>
            <img src="https://via.placeholder.com/300?text=Modern+Clock" alt="Modern Math">
        </div>
        <div id="converter" class="section">
            <h2>Converter</h2>
            <input type="text" id="input" placeholder="Number or Roman">
            <button onclick="convertInput()">Convert</button>
            <div id="result"></div>
        </div>
        <div id="builder" class="section">
            <h2>Drag-and-Drop Builder</h2>
            <p>Drag symbols to build a Roman numeral, see the value.</p>
            <div class="draggable" draggable="true" ondragstart="drag(event)" id="I">I</div>
            <div class="draggable" draggable="true" ondragstart="drag(event)" id="V">V</div>
            <div class="draggable" draggable="true" ondragstart="drag(event)" id="X">X</div>
            <div class="draggable" draggable="true" ondragstart="drag(event)" id="L">L</div>
            <div class="draggable" draggable="true" ondragstart="drag(event)" id="C">C</div>
            <div class="draggable" draggable="true" ondragstart="drag(event)" id="D">D</div>
            <div class="draggable" draggable="true" ondragstart="drag(event)" id="M">M</div>
            <div id="dropzone" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
            <div id="build-result"></div>
            <button onclick="resetBuilder()">Reset</button>
        </div>
        <div id="quiz" class="section">
            <h2>Quiz (Progressive Levels)</h2>
            <p>Level <span id="level">1</span>. Score: <span id="score">0</span></p>
            <div id="question"></div>
            <input type="text" id="quiz-input">
            <button onclick="checkQuiz()">Submit</button>
            <div id="quiz-result"></div>
        </div>
        <div id="matching" class="section">
            <h2>Matching Game</h2>
            <p>Drag Romans to match numbers.</p>
            <div class="draggable" draggable="true" ondragstart="drag(event)" id="match-I">I</div>
            <div class="draggable" draggable="true" ondragstart="drag(event)" id="match-V">V</div>
            <div class="draggable" draggable="true" ondragstart="drag(event)" id="match-X">X</div>
            <!-- Add more as needed -->
            <div class="pair">5: <div class="drop" ondrop="dropMatch(event, 5)" ondragover="allowDrop(event)"></div></div>
            <div class="pair">1: <div class="drop" ondrop="dropMatch(event, 1)" ondragover="allowDrop(event)"></div></div>
            <div class="pair">10: <div class="drop" ondrop="dropMatch(event, 10)" ondragover="allowDrop(event)"></div></div>
            <!-- Add more -->
            <div id="match-result"></div>
        </div>
        <div id="history" class="section">
            <h2>History & Background</h2>
            <p>Roman numerals originated in ancient Rome around 800 BC. Used for counting, in clocks, books. Example scenario: Emperor's legions numbered III (3).</p>
            <img src="https://via.placeholder.com/300?text=Roman+History" alt="History">
        </div>
    </div>
    <div id="character">
        <img src="https://via.placeholder.com/100?text=Roman+Character" alt="Character">
        <div id="speech">Welcome!</div>
    </div>
    <canvas id="cert-canvas" style="display:none;"></canvas>
    <script>
        let score = localStorage.getItem('score') || 0;
        document.getElementById('score').innerText = score;
        let level = 1;
        document.getElementById('level').innerText = level;

        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
            document.getElementById(id).style.display = 'block';
            if (id === 'quiz') startQuiz();
        }

        // Conversion functions
        const romanMap = [
            { value: 1000, numeral: "M" }, { value: 900, numeral: "CM" }, { value: 500, numeral: "D" },
            { value: 400, numeral: "CD" }, { value: 100, numeral: "C" }, { value: 90, numeral: "XC" },
            { value: 50, numeral: "L" }, { value: 40, numeral: "XL" }, { value: 10, numeral: "X" },
            { value: 9, numeral: "IX" }, { value: 5, numeral: "V" }, { value: 4, numeral: "IV" }, { value: 1, numeral: "I" }
        ];

        function numberToRoman(num) {
            let result = "";
            for (let { value, numeral } of romanMap) {
                while (num >= value) { result += numeral; num -= value; }
            }
            return result;
        }

        const romanToNumMap = { M: 1000, CM: 900, D: 500, CD: 400, C: 100, XC: 90, L: 50, XL: 40, X: 10, IX: 9, V: 5, IV: 4, I: 1 };

        function romanToNumber(roman) {
            let i = 0, num = 0;
            roman = roman.toUpperCase();
            while (i < roman.length) {
                let two = roman[i] + (roman[i + 1] || "");
                if (romanToNumMap[two]) { num += romanToNumMap[two]; i += 2; }
                else { num += romanToNumMap[roman[i]]; i++; }
            }
            return num;
        }

        function convertInput() {
            let input = document.getElementById('input').value.trim().toUpperCase();
            let result = document.getElementById('result');
            if (!isNaN(input)) {
                let num = parseInt(input);
                if (num < 1 || num > 3999) return result.innerText = "1-3999 only.";
                result.innerText = numberToRoman(num);
            } else {
                result.innerText = romanToNumber(input);
            }
        }

        // Drag drop
        function allowDrop(ev) { ev.preventDefault(); }
        function drag(ev) { ev.dataTransfer.setData("text", ev.target.id); }
        function drop(ev) {
            ev.preventDefault();
            let data = ev.dataTransfer.getData("text");
            let node = document.getElementById(data).cloneNode(true);
            ev.target.appendChild(node);
            let roman = ev.target.innerText;
            document.getElementById('build-result').innerText = romanToNumber(roman);
        }

        function resetBuilder() {
            document.getElementById('dropzone').innerHTML = '';
            document.getElementById('build-result').innerText = '';
        }

        // Quiz
        let currentQuestion;
        function startQuiz() {
            let max = level * 10;
            currentQuestion = Math.floor(Math.random() * max) + 1;
            document.getElementById('question').innerText = `Convert ${currentQuestion} to Roman (Scenario: Number of gladiators).`;
        }

        function checkQuiz() {
            let answer = document.getElementById('quiz-input').value.toUpperCase();
            let correct = numberToRoman(currentQuestion);
            let result = document.getElementById('quiz-result');
            if (answer === correct) {
                result.innerText = 'Correct!';
                score++;
                if (score % 5 === 0) level++;
                document.getElementById('speech').innerText = 'Great job!';
                localStorage.setItem('score', score);
                document.getElementById('score').innerText = score;
                document.getElementById('level').innerText = level;
            } else {
                result.innerText = `Wrong. Correct: ${correct}`;
                document.getElementById('speech').innerText = 'Try again!';
            }
            startQuiz();
            document.getElementById('quiz-input').value = '';
        }

        // Matching
        function dropMatch(ev, num) {
            ev.preventDefault();
            let data = ev.dataTransfer.getData("text");
            let symbol = document.getElementById(data).innerText;
            if (romanToNumber(symbol) === num) {
                ev.target.innerText = symbol;
                document.getElementById('match-result').innerText += 'Match! ';
                document.getElementById('speech').innerText = 'Good match!';
            } else {
                document.getElementById('speech').innerText = 'No match.';
            }
        }

        // Certificate
        function downloadCertificate() {
            let canvas = document.getElementById('cert-canvas');
            canvas.width = 400; canvas.height = 300;
            let ctx = canvas.getContext('2d');
            ctx.fillStyle = '#fff'; ctx.fillRect(0, 0, 400, 300);
            ctx.fillStyle = '#000'; ctx.font = '20px Arial';
            ctx.fillText('Certificate of Achievement', 50, 50);
            ctx.fillText('Roman Numerals Master', 50, 100);
            ctx.fillText(`Score: ${score} Level: ${level}`, 50, 150);
            let a = document.createElement('a');
            a.href = canvas.toDataURL('image/png');
            a.download = 'certificate.png';
            a.click();
        }

        showSection('tutorial');
    </script>
</body>
</html>
